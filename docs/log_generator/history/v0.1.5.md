## [v0.1.5] - 2026-02-19

### Summary
* 输出格式与配置命名进一步标准化（`yYYYY + mMM`，`alias_mapping.toml`）。
* 通宵场景从“固定窗口”改为“按天预算守恒”生成，长期日均时长可稳定接近 24h。
* 新增/强化月均统计能力，便于仅用于生成阶段的质量校验，不影响 `time_tracer` 正常消费日志。

### Format & Config
* Generated TXT month header format upgraded from `yYYYY` to `yYYYY + mMM`:
  * line 1: `yYYYY`
  * line 2: `mMM`
  * then day blocks (`MMDD`) and events.
* `log_generator` suite gained content assertions to prevent header regressions:
  * `2021-01.txt` must contain `m01`
  * `2027-12.txt` must contain `m12`
* Renamed config file:
  * `apps/log_generator/config/mapping_config.toml`
  * -> `apps/log_generator/config/alias_mapping.toml`
* Updated runtime/cmake/help/error-message references to use `alias_mapping.toml` consistently.
* `activities_config.toml` 支持 `[nosleep].probability`（0.0~1.0，仅在 `--nosleep` 启用时生效）。

### No-Sleep Time Budget Refactor
* `EventGenerator` 去除固定 `19h` 时间窗口逻辑，改为按天预算模型：
  * 以“上一天最后事件分钟”作为当日起点；
  * 当日目标预算围绕 `1440` 分钟分配；
  * 最后一段事件强制闭合到预算终点，避免系统性欠账。
* 通宵日与普通日统一在同一预算框架中生成，减少分支漂移。
* 新增跨月重置链路，避免状态跨月污染：
  * `EventGenerator::reset_for_new_month()`
  * `DayGenerator::reset_for_new_month()`
  * `LogGenerator::generate_for_month(...)` 月初调用重置
* 普通活动采样池过滤 wake 关键词，避免“wake 被当普通事件”导致时长统计被吞。

### Monthly Average Guardrail
* 可使用 `--monthly-average` 在生成时输出“每月日均追踪时长”。
* 典型 `--nosleep` 样本下，月均可稳定在接近 `24h/day` 区间（约 `23.96~24.00h/day`）。
* 该统计用于生成质量自检；实际被 `time_tracer` 消费的日志内容不新增统计行。

### Verification
* `python scripts/verify.py --app log_generator --build-dir build_fast --concise`
* `test/output/log_generator/result.json` 保持 `"success": true`

### Collaboration Note
* 关联协同文档 `temp/refactor-kt.md`（Android Kotlin 线性重构步骤）已推进完成。
* 该项主要属于 `tracer_android` 侧工程治理，未改变 `log_generator` CLI 输入输出契约。

### Update (P3 Completed)
* 已完成 `temp/no-sleep.md` 的 P3：新增“日均 24h”自动化回归检查。
* 新增统计脚本：
  * `test/suites/log_generator/scripts/check_daily_average.py`
* 新增 suite 场景：
  * `test/suites/log_generator/tests/commands_average_guard.toml`
  * 覆盖 `--nosleep` 与普通模式两组数据，统一断言区间 `23.8~24.2 h/day`。
* 聚合入口已接入：
  * `test/suites/log_generator/tests.toml`
* 为支持脚本化后置校验，测试框架新增 `raw_command` 选项（允许命令直接执行 Python 脚本而非强制前缀可执行文件）。
* 验证结果：
  * `python scripts/verify.py --app log_generator --build-dir build_fast --concise`
  * `test/output/log_generator/result.json` 为 `"success": true`
