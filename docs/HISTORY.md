# 开发历史 (HISTORY.md)

本文档记录了项目开发的主要里程碑和重构。
详细的、逐步的开发日志（包括所有子版本）已被归档到 `docs/history/` 目录中。

---


---

## [0.6.2] - 2026-02-22
**项目里程碑："Apollo-Soyuz"（阿波罗-联盟号）对接成功**
> **注记**：从 2026 年 2 月 14 日开始，截止到北京时间 2026 年 2 月 23 日 00:21，项目在春节期间完成了里程碑式的架构演进。通过剥离 `time_tracer_core` DLL 并实现与 Android 环境的深度“对接”，标志着项目正式跨越了平台鸿沟。
* **C ABI 全面稳定**：发布 `time_tracer_core_c_api.h`，确立了以 `tracer_core_*` 为命名的持久性 ABI 契约。
* **Windows CLI 薄壳化**：CLI 重构为轻量级包装器，通过动态加载 `time_tracer_core.dll` 执行，实现了与内核驱动的解耦。
* **数据流转链路归一化**：重构了跨端的数据统计语义，消除表现层冗余计算，完全由 Core 输出结构化统计结果。
* **持久化安全性增强**：启用 SQLite 外键约束与 UPSERT (ON CONFLICT DO UPDATE) 机制，确立了单文件替换导入契约。

---

## [0.6.1] - 2026-02-15
**里程碑：Android 环境联通与查询模型进化**
* **JNI 桥接实现**：建立 AndroidRuntimeFactory 与 JNI 接口，成功打通 Kotlin 与 C++ Core 的调用链路。
* **统一 Range 查询架构**：引入 `Range` 报告查询类型，统一了跨周/月/自定义时段的报告生成逻辑。
* **查询能力扩展**：新增活动建议算法（Activity Suggestion）与多维度项目树查询（Project Tree Query）。
* **格式化器 ABI 化**：通过模板化 ABI Wrapper 实现了报告格式化算法的跨端复用，规避了动态插件加载的复杂性。

---

## [0.6.0] - 2026-02-14
**里程碑：跨平台架构解耦与 DTO 契约确立**
* **UseCase 架构重构**：将业务逻辑收叠至 `ITimeTracerCoreApi`，确立了基于 DTO（Data Transfer Object）的调用模式。
* **基础设施接口化**：引入 Logging、Storage、Clock 等 Ports，为 Windows 与 Android 的环境差异提供了标准化的注入机制。
* **模块化归并**：系统性收敛了 Domain 校验规则、Converter 核心以及持久化 Schema，大幅降低了系统熵值。

---

---

## [0.5.8] - 2026-02-12
**里程碑：Clean Architecture 分层重构与 CLI 框架优化**
* **系统分层解耦**：按照 Clean Architecture 原则完成代码结构重构，将业务逻辑与技术细节分离，划分为 `api`、`domain`、`application`、`infrastructure` 及 `shared` 五个职责域。
* **CLI 与路由系统规范化**：重构了指令流处理架构，支持更灵活的检索参数组合，并规范了树状显示及数据查询的交互逻辑。
* **插件系统与存储层重构**：优化了数据传递机制，将插件接口（DLL）统一为 C-Style ABI 规范，并建立了一套标准化的输出诊断策略。
* **报表查询维度扩展**：核心体系增加了更严格的校验规则（包括超长活动拦截及豁免标识）；扩展了周历和年鉴分析支持，并完善了相关技术文档。

---

## [0.4.3.0] - 2026-01-20
**里程碑：跨月逻辑处理、TOML 配置体系与内存优化流水线**
* **跨月日志衔接优化**：引入 `LogLinker` 组件与逻辑判定技术，支持自动关联前月结尾活动，解决了跨月长时活动的手动补录问题。
* **配置体系迁移至 TOML**：将原有 JSON 配置架构迁移至 TOML，提升了配置文件的可读性与校验严格度。
* **内存预演验证机制**：建立 `Blink` 内存预演机制，在执行持久化操作前对数据进行一致性校验，防止无效数据入库。

---

## [0.3.26.0] - 2026-01-10
**里程碑：核心模块职责重定、路径处理强类型升级**
* **Importer 职责重定义**：明确了 `importer` 模块的职责范围，使其专注于接收由 `WorkflowHandler` 处理后的结构化数据，实现了业务逻辑与 IO 细节的进一步隔离。
* **时间格式规范化与路径类型升级**：系统内部路径处理由 `std::string` 升级为 `std::filesystem::path`，提升了跨平台兼容性；同步将表头及存储日期格式规范为 ISO 8601 标准。

---

## [0.3.25.0] - 2026-01-01
**里程碑：报表现示性能脱胎换骨的算法级重造与结构性解放**
* **规避性能炸弹的 `ProjectTreeFormatter` 算法剧变**：彻底下马了以前一直遗留在构建项目树状生成分析里那个随同节点纵深度无限延展而极易引爆触发栈上限坍塌报错的原始递归 DFS 算法路数，现全量基于平滑、稳定、不越界的 `std::stack` 迭代驱动。
* **独立抽离报表级动态运行组件库建立**：打造并分派释放出涵盖各项全局配置载体与共用处理逻辑集的公共型共享包体制（Shared DLL: `reports_shared` ）全面消臃减包缩减了各个独立文档子格式插件原本极为浮夸的巨无霸包体，使得程序迈入了依靠动态注册库环境唤醒插件的热加载行列。

---

## [0.3.24.0] - 2025-10-09
**里程碑：插件化（Plugin Architecture）阶段性破冰与完全剥离转换**
* 终结了报表输出机制从属于主体编译捆绑发版的情形。成功切割并将日照、月考以及特定期段（涵盖其项下的 `Md`, `Tex`, `Typ`等全体共计九大呈现格式库）解耦流放编译化身为游离独立加载状态存在的 `*.dll` 文件集群。

---

## [0.3.23.0] - 2025-09-21
**里程碑：基于 Strategy（策略模式）对陈旧巨石版报告引擎进行分拆救赎**
* 引入多项分发制的设计模式基准重新审视构建。创建设立以由 `IStatStrategy` 接管衍生出的不同独立特化的解析排版执行机构；全数剔去了盘根在各种样式工厂内由于重复摘抄和缝合叠加带来的海量堆积无效冗余行数代码，通过基于注册的工厂模型闭环了针对后续扩容开发的 OCP 原则实践。

---

## [0.3.21.0] - 2025-09-19
**里程碑：告别编码写死、踏入完全 JSON 动态配置化的渲染支持前夜**
* 重构建拔除了曾经深深嵌入并且绑定在 C++ 内部以粗暴写死方案（Hard-coding）操控包含但不限于版式字体、输出字号设定、间距调优管控甚至是配色高亮指定的配置方式，所有呈现相关的宏观以及细节特征全域向外暴露并对接上交通过读取特定的 `.json` 文件控制。

---

## [0.3.16.0] - 2025-09-13
**里程碑：全面数据化验证机制建立与跨年衔接缝合**
* 引进确立全新的合法数据准入屏障墙，摒除不再信任直接于原 TXT 日志输入进行规则强加判定体系的陈旧范式，确立“原文本解析 -> 标准 JSON 串过渡 -> 数据库终储”三元流转架构。
* 在过滤剔除掉系统借由推算跨年度时特设引入但不能并案输出的衔接类冗余脏数据（例如上年除夕 12-31）外，成功解决了并落实应对了无起床标志所触发引致的“大通宵”等极为繁剧特殊的记录追踪判定事件。

---













