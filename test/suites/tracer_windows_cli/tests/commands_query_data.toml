# Query Data command tests
[[commands]]
name = "Query Data Years"
stage = "query-data"
args = ["query", "data", "years", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Years Semantic Json"
stage = "query-data"
args = ["query", "data", "years", "--data-output", "json", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"schema_version\":1", "\"action\":\"years\"", "\"items\":", "\"total_count\":"]

[[commands]]
name = "Query Data Months 2026"
stage = "query-data"
args = ["query", "data", "months", "--year", "2026", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Days"
stage = "query-data"
args = ["query", "data", "days", "--year", "2026", "--month", "1", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Search"
stage = "query-data"
args = ["query", "data", "search", "--remark", "meeting", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Search Activity Remark Banana"
stage = "query-data"
args = ["query", "data", "search", "--remark", "banana", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Search Day Remark Betrayal"
stage = "query-data"
args = ["query", "data", "search", "--day-remark", "背叛", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Project Search"
stage = "query-data"
args = ["query", "data", "search", "--project", "study", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Days Stats Day Root"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "day", "--period-arg", "20260103", "--root", "study", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Day Root Missing"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "day", "--period-arg", "20260103", "--root", "nosuchroot", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "**Days**: 0"]

[[commands]]
name = "Query Data Days Stats Day Root Missing Semantic Json"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "day", "--period-arg", "20260103", "--root", "nosuchroot", "--top", "5", "--data-output", "json", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"schema_version\":1", "\"action\":\"days_stats\"", "\"output_mode\":\"semantic_json\"", "\"stats\":", "\"count\":0"]

[[commands]]
name = "Query Data Report Chart Root"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--root", "study", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"selected_root\":\"study\"", "\"average_duration_seconds\":", "\"series\":"]

[[commands]]
name = "Query Data Report Chart Root Overrides Project"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--project", "sleep", "--root", "study", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"selected_root\":\"study\""]

[[commands]]
name = "Query Data Report Chart Root Missing"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--root", "nosuchroot", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"selected_root\":\"nosuchroot\"", "\"total_duration_seconds\":0", "\"active_days\":0"]

[[commands]]
name = "Query Data Report Chart Root Missing Semantic Json"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--root", "nosuchroot", "--data-output", "json", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"schema_version\":1", "\"action\":\"report_chart\"", "\"output_mode\":\"semantic_json\"", "\"selected_root\":\"nosuchroot\"", "\"total_duration_seconds\":0", "\"active_days\":0"]

[[commands]]
name = "Query Data Report Chart Root Empty"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--root", "", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"selected_root\":\"\"", "\"range_days\":7", "\"series\":"]

[[commands]]
name = "Query Data Report Chart Root Empty Semantic Json"
stage = "query-data"
args = ["query", "data", "report-chart", "--from", "20260101", "--to", "20260107", "--root", "", "--data-output", "json", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["\"schema_version\":1", "\"action\":\"report_chart\"", "\"output_mode\":\"semantic_json\"", "\"selected_root\":\"\"", "\"range_days\":7", "\"series\":"]

[[commands]]
name = "Query Data Activity Suggest"
stage = "query-data"
args = ["query", "data", "activity-suggest", "--lookback-days", "10", "--top", "5", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Days Stats Day"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "day", "--period-arg", "20260103", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Week"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "week", "--period-arg", "2026-W01", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Month"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "month", "--period-arg", "202601", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Year"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "year", "--period-arg", "2026", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Recent"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "recent", "--period-arg", "7", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Days Stats Range"
stage = "query-data"
args = ["query", "data", "days-stats", "--period", "range", "--period-arg", "20260101|20260131", "--top", "5", "--database", "{db_path}"]
expect_exit = 0
expect_stdout_contains = ["## Day Duration Stats", "- **Days**:", "### Notes"]

[[commands]]
name = "Query Data Tree Day"
stage = "query-data"
args = ["query", "data", "tree", "--period", "day", "--period-arg", "20260103", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Week"
stage = "query-data"
args = ["query", "data", "tree", "--period", "week", "--period-arg", "2026-W01", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Month"
stage = "query-data"
args = ["query", "data", "tree", "--period", "month", "--period-arg", "202601", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Year"
stage = "query-data"
args = ["query", "data", "tree", "--period", "year", "--period-arg", "2026", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Recent"
stage = "query-data"
args = ["query", "data", "tree", "--period", "recent", "--period-arg", "7", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Range"
stage = "query-data"
args = ["query", "data", "tree", "--period", "range", "--period-arg", "20260101|20260131", "--database", "{db_path}"]
expect_exit = 0

[[commands]]
name = "Query Data Tree Day Level 1"
stage = "query-data"
args = ["query", "data", "tree", "--period", "day", "--period-arg", "20260103", "--level", "1", "--database", "{db_path}"]
expect_exit = 0
